<div class="box box-info">
    <div class="box-header with-border">
        <h3 class="box-title"><b>Schedules</b></h3>
    </div>
    <div class="box-body" style="min-height:700px;">
        <div id="classSchedules">
            <div class="container-fluid">
                <div class="row" style="margin-bottom:10px;">
                    <div style="padding:0px;width:auto;float:left;">
                        <button id="AddClassScheduleBtn" type="button" class="btn btn-block btn-primary "><i class="fa fa-plus"></i> Add New Class Schedule</button>
                    </div>
                </div>
                <div class="row">
                    <table id="classSchedulesTable" class="table table-bordered table-striped">
                        <thead>
                            <tr>
                                <th>Schedule Name</th>
                                <th>Class Type</th>
                                <th>Days</th>
                                <th>Schedule</th>
                                <th>Timings</th>
                                <th>Staff</th>
                                <th>Location</th>
                                <th>Room Layout</th>
                                <th>Edit</th>
                            </tr>
                        </thead>
                    </table>
                </div>
            </div>
            <script type="text/javascript">
            $(document).ready(function () {
                $('#classSchedulesTable').DataTable().clear();
                $('#classSchedulesTable').DataTable().destroy();
                $("#classSchedulesTable tbody")
                    .off("click", "tr td button.editClassSchedule");

                function loadData() {
                    var ins_table = $('#classSchedulesTable').DataTable({
                        "lengthMenu": [[5, 10, 25, 50], [5, 10, 25, 50]],
                        destroy:true,
                        "pagination": true,
                        "autoWidth": false,
                        "responsive": true,
                        "processing": true,
                        "serverSide": true,
                        "deferLoading": 0,
                        "search": {
                            "search": ""
                        },
                        'ajax': { "url": '@Url.Action("getclassschedules", "admin")', "type": "POST" },
                        'columns': [
                            { "data": "scheduleName" },
                            {data: "classType.className"},
                            { "data": "days" },
                            {
                                data: null,
                                render: function (data, type, row) {
                                    return row['startDate'].split('T')[0] + ' to ' + row['endDate'].split('T')[0];
                                }

                            },
                            {
                                data: null,
                                render: function (data, type, row) {
                                    return row['startTime'].split('T')[0] + ' to ' + row['endTime'].split('T')[0];
                                }

                            },
                            {
                                data: "classType",
                                render: function (data, type, row)
                                {
                                    return data.instructor.firstName + " " + data.instructor.lastName;

                                }
                            },
                            {"data": "classType.location.locationName"},
                            {
                                data: "roomLayout",
                                render: function (data, type, row)
                                {
                                    if (row["roomLayout"] == null)
                                        return "None";
                                    else
                                        return data.roomName;

                                }
                            },
                            {
                                data: "classScheduleID",
                                render: function (data, type, row) {
                                    return "<button class=\"editClassSchedule btn btn-info btn-flat\" data-i='"+data+"'><i class=\"fa fa-pencil\" aria-hidden=\"true\"></i></button>";
                                }
                            }
                        ]
                    });
                }
                loadData();


                $("#AddClassScheduleBtn").click(function () {
                    $("#classSchedules").load("@Url.Action("addClassSchedule", "admin")");
                });

                $('#classSchedulesTable tbody').on('click', 'tr td button.editClassSchedule', function () {
                    var c_id = $(this).data("i");
                    $.ajax({
                        url: '@Url.Action("updateClassSchedule", "admin")',
                        method: 'GET',
                        data: { classTypeID: c_id },
                        success: function (data) {
                            $("#classSchedules").html(data);
                        }

                    })
                });
            });
            </script>
        </div>
    </div>
    <!-- /.box-body -->
</div>
<!-- /.box -->